Thousands of parents have given up custody of their children under pressure from states in order to obtain treatment for the children's severe mental illnesses, federal investigators say, but some states have not lived up to their end of the deal.

Federal officials said they had found deplorable conditions in many state institutions where children were supposed to receive treatment.

For example, investigators from the civil rights division of the Justice Department recently found ''significant and wide-ranging deficiencies in patient care'' at Metropolitan State Hospital in Norwalk, Calif., near Los Angeles. The hospital provides patients ages 11 to 17 with ''woefully inadequate'' treatment and unnecessary medications, exposing them ''to a significant risk of harm and to actual harm,'' the department said.

Nora A. Romero, a spokeswoman for the California Department of Mental Health, said the state disagreed with some of the findings but was taking steps to improve care.